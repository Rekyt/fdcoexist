<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>fdcoexist equation only • fdcoexist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="fdcoexist equation only">
<meta property="og:description" content="fdcoexist">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fdcoexist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/equation_only.html">fdcoexist equation only</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="equation_only_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>fdcoexist equation only</h1>
                        <h4 class="author">Pierre Denelle, Matthias Grenié, Cyrille Violle, François Munoz and Caroline M. Tucker</h4>
            
            <h4 class="date">23 February 2021</h4>
      
      
      <div class="hidden name"><code>equation_only.Rmd</code></div>

    </div>

    
    
<div id="basic-equation" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-equation" class="anchor"></a>Basic Equation</h2>
<p>This document resumes the equation used in our model and details the different processes. Our coexistence model is developed following this equation (Beverton-Holt equation):</p>
<p><span class="math display">\[
N_{t+1, i, x} = \frac{R_{i, x} \times N_{t, i, x}}{1 + A \times \alpha_i}
\]</span></p>
<p>with <span class="math inline">\(N_{t+1, i, x}\)</span> the abundance of species <span class="math inline">\(i\)</span> in patch <span class="math inline">\(x\)</span> at time <span class="math inline">\(t + 1\)</span>, <span class="math inline">\(R_{i, x}\)</span> the growth of species <span class="math inline">\(i\)</span> in patch <span class="math inline">\(x\)</span>, <span class="math inline">\(A\)</span> the constant for inter-specific competition and <span class="math inline">\(\alpha_i\)</span> the competition coefficient for species <span class="math inline">\(i\)</span>. We can detail both <span class="math inline">\(R_{i, x}\)</span> and <span class="math inline">\(\alpha_i\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha_i = \sum_{j = 1, j \neq i}^{S} N_{t, j, x} \times \sigma_{ij}\\
R_{i, x} = k \times \exp\left(- \frac{(t_i - e_x)^2}{2\times {l_x}^2}\right)
\end{aligned}
\]</span></p>
<p>with <span class="math inline">\(\sigma_{ij}\)</span> the functional similarity between species <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>; we see that <span class="math inline">\(\alpha_i\)</span> gets bigger as species <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are more similar and as species <span class="math inline">\(j\)</span> is more abundant. And with <span class="math inline">\(t_i\)</span> the trait of species <span class="math inline">\(i\)</span>, <span class="math inline">\(e_x\)</span> the environmental value of patch <span class="math inline">\(x\)</span> and <span class="math inline">\({l_x}^2\)</span> the width of the environmental filter in patch <span class="math inline">\(x\)</span>.</p>
<p>If we replace <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(R_{i, x}\)</span> in the first equation it gives:</p>
<p><span class="math display">\[
N_{t+1, i, x} = \frac{
k \times \exp\left[- \frac{\displaystyle\left(\sum_{g = 1}^T w_g t_g - e_x\right)^2}{2\times {l_x}^2}\right] \times N_{t, i, x}}{
1 + A \times \displaystyle\sum_{j = 1, j \neq i}^{S} N_{t, j, x} \times \sigma_{ij}
}
\]</span></p>
</div>
<div id="detailing-the-computation-of-delta_ij-sigma_ij" class="section level2">
<h2 class="hasAnchor">
<a href="#detailing-the-computation-of-delta_ij-sigma_ij" class="anchor"></a>Detailing the computation of <span class="math inline">\(\delta_{ij}\)</span> &amp; <span class="math inline">\(\sigma_{ij}\)</span>
</h2>
<p><span class="math inline">\(\delta_{ij}\)</span> is the functional dissimilarity coefficient between species <span class="math inline">\(i\)</span> and species <span class="math inline">\(j\)</span>. It reflects the fact that the more two species are dissimilar the less competition they experience from each other.</p>
<p>First we can compute <span class="math inline">\(\delta_{ij}\)</span> as the euclidean distance between species using multiple traits:</p>
<p><span class="math display">\[
\delta_{ij} = \sqrt{\sum_{c = 1}^{T} (t_{i, c} - t_{j, c})^2}, 
\]</span></p>
<p>with <span class="math inline">\(T\)</span> the number of traits, <span class="math inline">\(t_{i, c}\)</span> trait <span class="math inline">\(c\)</span> of species <span class="math inline">\(i\)</span> and <span class="math inline">\(t_{j, c}\)</span> trait <span class="math inline">\(c\)</span> of species <span class="math inline">\(j\)</span>. If want to take the contribution of traits to competition we have to modify the trait values as follow:</p>
<p><span class="math display">\[
\begin{aligned}
\delta_{ij} = \sqrt{\sum_{c = 1}^{T} \left[ \sqrt{w_c} (t_{i, c} - t_{j, c})\right]^2}\\
\delta_{ij} = \sqrt{\sum_{c = 1}^{T} w_c \times (t_{i, c} - t_{j, c})^2},
\end{aligned}
\]</span></p>
<p>with <span class="math inline">\(w_c\)</span> the contribution of trait <span class="math inline">\(c\)</span> in limiting similarity and we have <span class="math inline">\(\sum_{c = 1}^{T_c} w_c = 1\)</span>.</p>
<p>In order to consider that the effect of limiting similarity is non-linear we use an exponent on distances: <span class="math display">\[
\begin{aligned}
{\delta_{ij}}' &amp;= {\delta_{ij}}^2\\
               &amp;= \left(\sqrt{\sum_{c = 1}^{T} w_c \times (t_{i, c} - t_{j, c})^2}\right)^2 \\
               &amp;= \sum_{c = 1}^{T} w_c \times (t_{i, c} - t_{j, c})^2
\end{aligned}
\]</span></p>
<p>We use <span class="math inline">\(\max({\delta_{ij}}') - {\delta_{ij}}'\)</span> in above-mentioned equations to consider limiting similarity (closer species experience higher inter-specific competition) thus we can use a similarity term:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma_{ij} = \max({\delta_{ij}}') - {\delta_{ij}}',\quad \sigma_{ii} = 0 ~\forall~i \in [1, S] \\
\end{aligned}
\]</span></p>
</div>
<div id="adding-intra-specific-competition" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-intra-specific-competition" class="anchor"></a>Adding intra-specific competition</h2>
<p>The equation above only considers inter-specific competition when <span class="math inline">\(j \neq i\)</span> in the sum. We can however add intra-specific competition when <span class="math inline">\(j = i\)</span>. Each site has a species-specific carrying capacity <span class="math inline">\(K\)</span> as the number of individuals approaches this carrying capacity the intra-specific competition increases:</p>
<p><span class="math display">\[
\alpha_{ii} = B \times N_{t,i,x}
\]</span></p>
<p>Thus the equation becomes:</p>
<p><span class="math display">\[
N_{t+1, i, x} = \frac{
k \times \exp\left(- \displaystyle\frac{(t_i - e_x)^2}{2\times {l_x}^2}\right) \times N_{t, i, x}}{
1 + A \displaystyle\sum_{j = 1,~j \neq i}^{S} N_{t, j, x} \times \sigma_{ij} +
B \times N_{t,i,x}
}
\]</span></p>
<p>with <span class="math inline">\(B\)</span> the coefficient scaling intra-specific competition.</p>
</div>
<div id="multi-trait-growth-term" class="section level2">
<h2 class="hasAnchor">
<a href="#multi-trait-growth-term" class="anchor"></a>Multi-trait growth term</h2>
<p>Because several traits participate to the growth term depending on their contribution we can rewrite the growth term as:</p>
<p><span class="math display">\[
R_{i, x} = \sum_{g = 1}^{T} w_g \times k \times \exp\left(- \frac{(t_{i, g} - e_x)^2}{2\times {l_x}^2} \right)
\]</span></p>
<p>with <span class="math inline">\(g\)</span> the trait number, <span class="math inline">\(0 \leq w_g \leq 1\)</span> the contribution of this trait to growth (and <span class="math inline">\(\sum_{g = 1}^{T} w_g = 1\)</span>), <span class="math inline">\(t_{i, g}\)</span> the trait number <span class="math inline">\(g\)</span> of species <span class="math inline">\(i\)</span>.</p>
<p>If want to account for multiple traits contributing to growth the easiest way is to consider composite traits such as:</p>
<p><span class="math display">\[
t_i = \sum_{g = 1}^T w_g t_g
\]</span> with <span class="math inline">\(w_g\)</span> the contribution of trait to growth such that <span class="math inline">\(\sum w_g = 1\)</span>, <span class="math inline">\(t_g\)</span> the <span class="math inline">\(g\)</span>th trait, and <span class="math inline">\(T\)</span> the total number of traits.</p>
<p>And thus <span class="math inline">\(R_{i, x}\)</span> becomes:</p>
<p><span class="math display">\[
R_{i, x} = k \times \exp\left[- \frac{\displaystyle\left(\sum_{g = 1}^T w_g t_g - e_x\right)^2}{2\times {l_x}^2}\right]
\]</span></p>
</div>
<div id="adding-hierarchical-competition" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-hierarchical-competition" class="anchor"></a>Adding Hierarchical competition</h2>
<p>We want hierarchical competition to depends on the species present in the community and the distance of species such that smallest species get their growth reduced by tallest species in proportion of their distances and abundances. So the competition term of a species <span class="math inline">\(i\)</span> in patch <span class="math inline">\(x\)</span> at time <span class="math inline">\(t\)</span> can be: <span class="math display">\[
H_{tix} = H \sum_{
                \substack{j = 1\\
                          t_j \ge t_i}}^S
           (t_j - t_i) N_{tjx}
\]</span> with <span class="math inline">\(H\)</span> the scale for hierarchical competition <span class="math inline">\(t_j\)</span> the trait of species <span class="math inline">\(j\)</span>, <span class="math inline">\(t_i\)</span> the trait of species <span class="math inline">\(i\)</span> and <span class="math inline">\(N_{tjx}\)</span> the abundance of species <span class="math inline">\(j\)</span> at time <span class="math inline">\(t\)</span> in patch <span class="math inline">\(x\)</span>. To account for the fact that hierarchical competition has a negative influence on growth we add a minus sign in front of the equation which becomes: <span class="math display">\[
H_{tix} = - H \sum_{
                \substack{j = 1\\
                          t_j \ge t_i}}^S
           (t_j - t_i) N_{tjx}
\]</span> If we wabt to consider multiple traits with different contributions we can generalize the equation using the same principle as for limiting similarity: <span class="math display">\[
H_{tix} = - H \sum_{h = 1}^T w_h \sum_{
                \substack{j = 1\\
                          t_{j, h} \ge t_{i, h}}}^S
           (t_{j, h} - t_{i, h}) N_{tjx}
\]</span> with <span class="math inline">\(w_h\)</span> the hierarchical weight of trait <span class="math inline">\(h\)</span> among the <span class="math inline">\(T\)</span> traits, with <span class="math inline">\(\sum w_h = 1\)</span>.</p>
<p>Finally we can consider that hierarchical competition is not linear with the trait difference but instead that taller species have a saturating influence on smaller species (a tree of 10m or 50m will have almost similar influence for light interception for grasses 0.5m high). To account for that we can scale the distances using a square root:</p>
<p><span class="math display">\[
H_{tix} = - H \sum_{h = 1}^T w_h \sum_{
                \substack{j = 1\\
                          t_{j, h} \ge t_{i, h}}}^S
            N_{tjx} \sqrt{t_{j, h} - t_{i, h}}
\]</span></p>
</div>
<div id="adding-dispersal" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-dispersal" class="anchor"></a>Adding dispersal</h2>
<p>In our model we consider dispersal between patches as if all patches were in a meta-community. At each time step a proportion <span class="math inline">\(d\)</span> of inviduals for each species move across patches. <span class="math inline">\(d\)</span> percent of individuals leave each patch and move evenly across patches.</p>
<p>The dispersion is thus <span class="math display">\[
\begin{aligned}
    N_{t, i, x, \text{leaving}} &amp;= d \times N_{t, i, x} \\
    N_{t, i, x, \text{sedentaries}} &amp;= N_{t, i, x} - N_{t, i, x, \text{leaving}} = N_{t, i, x} - d \times N_{t, i, x} \\
    N_{t, i, x, \text{sedentaries}} &amp;= (1 - d) N_{t, i, x}\\
\end{aligned}
\]</span></p>
<p>For then for each species all immigrants are split evenly across patches:</p>
<p><span class="math display">\[
    N_{t, i, \text{migrants}} = \sum_{k = 1}^{k = 25} d \times N_{t, i, k}
\]</span></p>
<p>Finally the number of inviduals in the patch after dispersal becomes:</p>
<p><span class="math display">\[
\begin{aligned}
N_{t, i, x} = N_{t, i, x, \text{sedentaries}} + \frac{N_{t, i, \text{migrants}}}{25} \\
N_{t, i, x} = (1 - d) N_{t, i, x} + d \frac{\displaystyle\sum_{k = 1}^{k = 25} N_{t, i, k}}{25}\\
N_{t, i, x} = (1 - \frac{24}{25}d) N_{t, i, x} + d \frac{\displaystyle\sum_{k = 1, k \neq x}^{k = 25} N_{t, i, k}}{25} \\
N_{t, i, x} = N_{t, i, x} \underbrace{- d N_{t,i,x} + d \frac{\displaystyle\sum_{k = 1}^{k = 25} N_{t, i, k}}{25}}_{D_{t,i,x}} \\
D_{t, i, x} = - d N_{t,i,x} + d \frac{\displaystyle\sum_{k = 1}^{k = 25} N_{t, i, k}}{25}
\end{aligned}
\]</span></p>
</div>
<div id="final-equation" class="section level2">
<h2 class="hasAnchor">
<a href="#final-equation" class="anchor"></a>Final equation</h2>
<div id="single-trait-contributing-to-everything" class="section level3">
<h3 class="hasAnchor">
<a href="#single-trait-contributing-to-everything" class="anchor"></a>Single trait contributing to everything</h3>
<p>If a single trait contributes to everything than the equation simplifies as there is no need to to account for the difference in contribution to the different processes the final equation is thus:</p>
<p><span class="math display">\[
\begin{aligned}
N_{t+1, i, x} &amp;= \frac{R_{i,x} + H_{t,i,x}}{1 + A_{t, i, x} + B_{t, i, x}} N_{t, i, x} + D_{t, i, x}\\
              &amp;= \frac{
               \displaystyle k \times \exp\left(- \frac{(t_i - e_x)^2}{2\times {l_x}^2}\right) - H \sum_{\substack{j = 1\\ t_j &gt; t_i}}^S N_{t, j, x} \sqrt{t_j - t_i}
               }{
               \displaystyle 1 +
               A \left( \sum_{j = 1, j \neq i}^{S} N_{t, j, x} (t_i - t_j)^2\right) +
               B \times N_{t,i,x}
               } N_{t, i, x} + D_{t, i, x}
\end{aligned}
\]</span></p>
</div>
<div id="multiple-traits-co-contributing-to-some-processes" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-traits-co-contributing-to-some-processes" class="anchor"></a>Multiple traits co-contributing to some processes</h3>
<p>To account for the various contributions of multiple processes to the different processes the final equation is:</p>
<p><span class="math display">\[
\begin{aligned}
N_{t+1, i, x} &amp;= \frac{R_{i,x} + H_{t,i,x}}{1 + A_{t, i, x} + B_{t, i, x}} N_{t, i, x} + D_{t, i, x}\\
              &amp;= \frac{
               \displaystyle k \times \exp\left[- \frac{\left(\sum_{g = 1}^T w_g t_g - e_x\right)^2}{2\times {l_x}^2}\right]
               - H \sum_{h = 1}^T \sum_{\substack{j = 1\\ t_{j, h} \ge t_{i, h}}}^S w_h \, N_{tjx} \,\sqrt{t_{j, h} - t_{i, h}}
               }{
               \displaystyle 1 +
               A \left( \sum_{j = 1, j \neq i}^{S} \sum_{c = 1}^{T} w_c \, N_{t, j, x} \, (t_{i, c} - t_{j, c})^2\right) +
               B \times N_{t,i,x}
               } N_{t, i, x} + D_{t, i, x}
\end{aligned}
\]</span></p>
<p>with <span class="math inline">\(w_g\)</span>, <span class="math inline">\(w_h\)</span> and <span class="math inline">\(w_c\)</span>, the contribution respectively of trait to growth, hierarchical competition and limiting similarity with <span class="math inline">\(T\)</span> the number of traits.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthias Grenié, Pierre Denelle, Caroline Tucker, François Munoz, Cyrille Violle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
